<%- include('header') %>

<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>
        <i class="fas fa-book me-2"></i>Knowledge Base
    </h2>
    <div class="input-group" style="max-width: 300px;">
        <input type="text" class="form-control" placeholder="Search articles..." id="searchInput">
        <button class="btn btn-outline-secondary" type="button">
            <i class="fas fa-search"></i>
        </button>
    </div>
</div>

<div class="row mb-4">
    <div class="col-12">
        <div class="alert alert-info">
            <i class="fas fa-lightbulb me-2"></i>
            <strong>Quick Solutions</strong> - Find answers to common technical issues and step-by-step guides.
        </div>
    </div>
</div>

<div class="row g-4 mb-4">
    <div class="col-md-4">
        <div class="card h-100 text-center">
            <div class="card-body">
                <i class="fas fa-desktop fa-3x text-primary mb-3"></i>
                <h5>Hardware Issues</h5>
                <p class="text-muted">Troubleshooting computer, printer, and monitor problems</p>
                <span class="badge bg-primary">12 Articles</span>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card h-100 text-center">
            <div class="card-body">
                <i class="fas fa-laptop-code fa-3x text-success mb-3"></i>
                <h5>Software Help</h5>
                <p class="text-muted">Application installation, updates, and configuration</p>
                <span class="badge bg-success">18 Articles</span>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card h-100 text-center">
            <div class="card-body">
                <i class="fas fa-network-wired fa-3x text-warning mb-3"></i>
                <h5>Network & Email</h5>
                <p class="text-muted">Connectivity, WiFi, and email configuration guides</p>
                <span class="badge bg-warning">15 Articles</span>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-star me-2"></i>Popular Articles
                </h5>
            </div>
            <div class="card-body">
                <% if (articles.length === 0) { %>
                    <div class="text-center py-4">
                        <i class="fas fa-book-open fa-3x text-muted mb-3"></i>
                        <h5 class="text-muted">No articles available</h5>
                        <p class="text-muted">Knowledge base articles will appear here when added.</p>
                    </div>
                <% } else { %>
                    <div class="article-list">
                        <% articles.forEach((article, index) => { %>
                            <div class="article-item <% if (index < articles.length - 1) { %>border-bottom<% } %> pb-3 mb-3">
                                <div class="d-flex justify-content-between align-items-start">
                                    <div class="flex-grow-1">
                                        <h6 class="mb-2">
                                            <a href="#" class="text-decoration-none article-link" data-bs-toggle="modal" data-bs-target="#articleModal" 
                                               data-title="<%= article.title %>" data-content="<%= article.content %>">
                                                <%= article.title %>
                                            </a>
                                        </h6>
                                        <p class="text-muted mb-2 article-preview">
                                            <%= article.content.substring(0, 150) %>...
                                        </p>
                                        <div class="d-flex align-items-center text-muted small">
                                            <span class="badge bg-light text-dark me-2"><%= article.category %></span>
                                            <i class="fas fa-calendar me-1"></i>
                                            <%= moment(article.created_at).format('MMM DD, YYYY') %>
                                            <i class="fas fa-eye ms-3 me-1"></i>
                                            <%= Math.floor(Math.random() * 500) + 100 %> views
                                        </div>
                                    </div>
                                    <div class="text-end">
                                        <div class="rating mb-2">
                                            <% for (let i = 0; i < 5; i++) { %>
                                                <i class="fas fa-star text-warning"></i>
                                            <% } %>
                                            <small class="text-muted ms-1">(4.8)</small>
                                        </div>
                                        <small class="text-success">
                                            <i class="fas fa-thumbs-up me-1"></i>95% helpful
                                        </small>
                                    </div>
                                </div>
                            </div>
                        <% }); %>
                    </div>
                <% } %>
                
                <div class="mt-4">
                    <h6>Additional Knowledge Base Articles:</h6>
                    <div class="list-group">
                        <a href="#" class="list-group-item list-group-item-action">
                            <div class="d-flex w-100 justify-content-between">
                                <h6 class="mb-1">How to Reset Windows Password</h6>
                                <small>Account Management</small>
                            </div>
                            <p class="mb-1">Step-by-step guide to reset your Windows login password when you can't access your account.</p>
                        </a>
                        <a href="#" class="list-group-item list-group-item-action">
                            <div class="d-flex w-100 justify-content-between">
                                <h6 class="mb-1">Troubleshooting WiFi Connection Issues</h6>
                                <small>Network</small>
                            </div>
                            <p class="mb-1">Common solutions for WiFi connectivity problems including driver updates and network reset.</p>
                        </a>
                        <a href="#" class="list-group-item list-group-item-action">
                            <div class="d-flex w-100 justify-content-between">
                                <h6 class="mb-1">Installing and Configuring Antivirus Software</h6>
                                <small>Security</small>
                            </div>
                            <p class="mb-1">Guide to choosing, installing, and configuring antivirus protection for your computer.</p>
                        </a>
                        <a href="#" class="list-group-item list-group-item-action">
                            <div class="d-flex w-100 justify-content-between">
                                <h6 class="mb-1">Email Setup for Outlook and Mobile Devices</h6>
                                <small>Email</small>
                            </div>
                            <p class="mb-1">Complete instructions for setting up email accounts on Outlook, iPhone, and Android devices.</p>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card mb-4">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="fas fa-question-circle me-2"></i>Need More Help?
                </h6>
            </div>
            <div class="card-body">
                <p class="card-text">Can't find what you're looking for? Our support team is here to help.</p>
                <% if (user) { %>
                    <a href="/tickets/new" class="btn btn-primary btn-sm mb-2 w-100">
                        <i class="fas fa-plus me-1"></i>Create Support Ticket
                    </a>
                <% } else { %>
                    <a href="/login" class="btn btn-primary btn-sm mb-2 w-100">
                        <i class="fas fa-sign-in-alt me-1"></i>Login for Support
                    </a>
                <% } %>
                <div class="text-center mt-3">
                    <small class="text-muted">
                        <i class="fas fa-phone me-1"></i>Emergency: +1-800-TECH-HELP<br>
                        <i class="fas fa-envelope me-1"></i>support@techhelp.com
                    </small>
                </div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="fas fa-fire me-2"></i>Trending Topics
                </h6>
            </div>
            <div class="card-body">
                <div class="list-group list-group-flush">
                    <a href="#" class="list-group-item list-group-item-action border-0 px-0">
                        <small class="text-muted">Windows Update Issues</small>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action border-0 px-0">
                        <small class="text-muted">Printer Not Responding</small>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action border-0 px-0">
                        <small class="text-muted">Slow Computer Performance</small>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action border-0 px-0">
                        <small class="text-muted">Email Sync Problems</small>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Article Modal -->
<div class="modal fade" id="articleModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalTitle">Article Title</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div id="modalContent">Article content...</div>
                <hr>
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <span class="text-muted">Was this article helpful?</span>
                    </div>
                    <div>
                        <button class="btn btn-sm btn-outline-success me-2">
                            <i class="fas fa-thumbs-up"></i> Yes
                        </button>
                        <button class="btn btn-sm btn-outline-danger">
                            <i class="fas fa-thumbs-down"></i> No
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Search functionality
    const searchInput = document.getElementById('searchInput');
    const articleItems = document.querySelectorAll('.article-item');
    
    searchInput.addEventListener('input', function() {
        const searchTerm = this.value.toLowerCase();
        
        articleItems.forEach(item => {
            const title = item.querySelector('h6 a').textContent.toLowerCase();
            const content = item.querySelector('.article-preview').textContent.toLowerCase();
            
            if (title.includes(searchTerm) || content.includes(searchTerm)) {
                item.style.display = 'block';
            } else {
                item.style.display = 'none';
            }
        });
    });
    
    // Article modal
    const articleLinks = document.querySelectorAll('.article-link');
    const modalTitle = document.getElementById('modalTitle');
    const modalContent = document.getElementById('modalContent');
    
    articleLinks.forEach(link => {
        link.addEventListener('click', function() {
            modalTitle.textContent = this.getAttribute('data-title');
            modalContent.textContent = this.getAttribute('data-content');
        });
    });
});
</script>

<%- include('footer') %>
